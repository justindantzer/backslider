/*!
 * jQuery Plugin: Backslider
 * Author: @justindantzer
 * Licensed under the MIT license
 * 
 * action       string    choose nav control trigger action, defaults to 'click'
 * allowpause   bool      specify display of pause button, defaults to 1
 * controls     bool      show navigation controls
 * equalheight  bool      choose to set parent to height of tallest slide, defaults to 0
 * interval     int       set auto-advance interval in milliseconds, defaults to 10000
 * navtext      string    set the attribute containing text for the nav link
 * nextprev     bool      include next/previous controls
 * pauseimage   string    set url for image to be used as pause button
 * separator    string    used as separator in nav controls
 */

(function(e){e.Backslider=function(t,n){function i(){var t=e("<nav/>").appendTo(r.el);if(r.opts.allowpause){if(""!=r.opts.pauseimage){e("<img />").attr({"class":"pause",src:r.opts.pauseimage,alt:"Pause"}).appendTo(t)}else{e("<span/>").attr({"class":"pause"}).text("Pause").appendTo(t)}}if(r.opts.nextprev){e("<a/>").attr("class","previous").html("Previous").appendTo(t)}var n=e("<ol/>").appendTo(t);e.each(r.slides,function(t){if(""!=r.opts.separator&&t>0){e("<li/>").attr({"class":"separator"}).text(r.opts.separator).appendTo(n)}var i=t+1;if(""!=r.opts.navtext&&undefined!=r.slides.eq(t).attr(r.opts.navtext))i=r.slides.eq(t).attr(r.opts.navtext);e("<li/>").addClass(r.index==t?"sel":"").text(i).appendTo(n)});if(r.opts.nextprev){e("<a/>").attr("class","next").html("Next").appendTo(t)}if(r.opts.allowpause)r.el.find(".pause").on("click",r.stop);r.el.find("nav > ol > li:not(.separator)").on(r.opts.action,function(){var t=e(this);r.stop().set(t.parent().children(":not(.separator)").index(t)).start()});r.el.find(".next, .previous").on("click",function(){if(e(this).is(".next")){var t=r.index+1>=r.slides.length?0:r.index+1}else{var t=r.index-1<0?r.slides.length-1:r.index-1}r.stop().set(t).start()})}var r=this;r.opts={action:"click",allowpause:false,controls:true,equalheight:false,interval:1e4,navtext:"",nextprev:false,pauseimage:"",separator:""};r.init=function(n){r.opts=e.extend(r.opts,n||{});r.el=e(t);r.slides=r.el.find("> :not(nav)");r.index=0;r.slides.eq(r.index).addClass("current");if(r.opts.controls)i();if(r.opts.equalheight){r.equalheight();e(window).resize(r.windowresize)}r.el.addClass("backslider-enabled");if(r.opts.interval>0)r.start()};r.equalheight=function(t){var n=t||Math.max.apply(null,r.slides.map(function(){return e(this).innerHeight()}).get());r.el.height(n)};r.set=function(e){if(typeof e==undefined)return;r.index=e;r.el.find("nav ol > li:not(.separator)").eq(e).addClass("sel").siblings().removeClass("sel");r.slides.eq(e).addClass("current").siblings().removeClass("current");return r};r.start=function(){r.timer=setInterval(function(){var e=r.index+1>=r.slides.length?0:r.index+1;r.set(e)},r.opts.interval);if(r.opts.allowpause)r.el.find(".play").removeClass("play");return r};r.stop=function(){r.timer=clearInterval(r.timer);if(r.opts.allowpause)r.el.find(".pause").addClass("play");return r};r.windowresize=function(){if(r.opts.equalheight){r.resizetimer=clearTimeout(r.resizetimer);r.resizetimer=setTimeout(r.equalheight,50)}};r.init(n);};e.fn.backslider=function(t){return this.each(function(){new e.Backslider(this,t)})}})(jQuery);